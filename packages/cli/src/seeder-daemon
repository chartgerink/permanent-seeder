#!/usr/bin/env node

const { SDK } = require('@geut/permanent-seeder-sdk')

const seederDaemon = async () => {
  const config = JSON.parse(process.argv[2])

  const sdk = new SDK(config)

  await sdk.start()

  process.on('message', function (packet, handler) {
    if (packet.topic === 'keys:add') {
      sdk.addKey(packet.data)
    }
  })
}

seederDaemon().catch(error => {
  console.error(error)
  process.exit(1)
})
